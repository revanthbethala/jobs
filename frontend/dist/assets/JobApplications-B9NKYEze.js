import{z as T,y as E,f as k,r as B,j as e,B as f,C as D,D as _,I as S,E as M,T as F,F as R,G as u,H as n,J as $,K as t,M as j,P as J,Q as H,R as P}from"./index-B6peOCw_.js";import{A as Q}from"./arrow-left-OB26W1DN.js";import{S as G}from"./search-CHkgBHUu.js";import{D as I}from"./download-GkHA3vAk.js";import{f as b}from"./format-DnD798-5.js";function V(){const{jobId:d}=T(),{data:o,isLoading:N,isError:g}=E({queryKey:["job-applications",d],queryFn:()=>P(d),enabled:!!d}),y=k(),w=()=>{const a=m?.map(l=>{const r=l.user,A=r.education?.find(c=>c.educationalLevel==="B.Tech"),L=r.education?.find(c=>c.educationalLevel==="12th"||c.educationalLevel?.toLowerCase()==="diploma"),C=r.education?.find(c=>c.educationalLevel==="10th");return{"Full Name":`${r.firstName} ${r.lastName}`,Username:r.username,Email:r.email,Phone:r.phoneNumber,Gender:r.gender,Resume:"http://localhost:3000"+l.resume,"B.Tech %":A?.percentage??"N/A","12th/Diploma %":L?.percentage??"N/A","10th %":C?.percentage??"N/A","Applied At":b(new Date(l.appliedAt),"dd MMM yyyy")}}),s=j.json_to_sheet(a||[]),i=j.book_new();j.book_append_sheet(i,s,"Applications");const p=J(i,{bookType:"xlsx",type:"array"}),x=new Blob([p],{type:"application/octet-stream"});H.saveAs(x,`Job_Applications_${o?.jobTitle||"Export"}.xlsx`)},[h,v]=B.useState(""),m=o?.applications.filter(a=>{const s=`${a.user.firstName} ${a.user.lastName}`.toLowerCase(),i=a.user.username.toLowerCase();return s.includes(h.toLowerCase())||i.includes(h.toLowerCase())});return N?e.jsx("div",{className:"p-4",children:"Loading..."}):g?e.jsx("div",{className:"p-4 text-red-500",children:"Failed to load applications."}):e.jsxs("div",{children:[e.jsxs(f,{variant:"outline",className:"flex gap-1",onClick:()=>y("/posted-jobs"),children:[e.jsx(Q,{})," Back to Jobs"]}),e.jsxs(D,{className:"m-4 shadow-xl border",children:[e.jsxs(_,{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-semibold capitalize",children:["Applications for: ",o?.jobTitle]}),e.jsxs("h3",{className:"font-medium text-brand-blue-dark",children:["Applications Received:",o?.applications?.length<10?`0${o?.applications?.length}`:o?.applications?.length]})]}),e.jsxs("div",{className:"relative w-full md:w-1/3",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(S,{className:"pl-10",placeholder:"Search by name or username...",value:h,onChange:a=>v(a.target.value)})]}),e.jsx(f,{onClick:w,className:" bg-brand-blue-light hover:bg-brand-blue-light/80 mt-2 md:mt-0",children:"Export to Excel"})]}),e.jsx(M,{className:"overflow-x-auto",children:e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(u,{children:[e.jsx(n,{children:"Full Name"}),e.jsx(n,{children:"Username"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Phone"}),e.jsx(n,{children:"Gender"}),e.jsx(n,{children:"Resume"}),e.jsx(n,{children:"B.Tech"}),e.jsx(n,{children:"12th/Diploma"}),e.jsx(n,{children:"10th"}),e.jsx(n,{children:"Applied At"})]})}),e.jsx($,{children:m?.length>0?m.map(a=>{const s=a.user,i=s.education?.find(l=>l.educationalLevel==="B.Tech"),p=s.education?.find(l=>l.educationalLevel==="12th"||l.educationalLevel?.toLowerCase()==="diploma"),x=s.education?.find(l=>l.educationalLevel==="10th");return e.jsxs(u,{children:[e.jsxs(t,{children:[s.firstName," ",s.lastName]}),e.jsx(t,{children:s.username}),e.jsx(t,{children:s.email}),e.jsx(t,{children:s.phoneNumber}),e.jsx(t,{children:s.gender}),e.jsx(t,{children:e.jsxs("a",{href:"http://localhost:3000"+a.resume,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline flex items-center gap-1",children:["View ",e.jsx(I,{className:"w-4 h-4"})]})}),e.jsxs(t,{children:[i?.percentage??"N/A","%"]}),e.jsxs(t,{children:[p?.percentage??"N/A","%"]}),e.jsxs(t,{children:[x?.percentage??"N/A","%"]}),e.jsx(t,{children:b(new Date(a.appliedAt),"dd MMM yyyy")})]},a.id)}):e.jsx(u,{children:e.jsx(t,{colSpan:10,className:"text-center text-gray-500 py-4",children:"No applications found."})})})]})})]})]})}export{V as default};
